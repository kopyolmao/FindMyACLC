<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ACLC Lost and Found - Find Your Lost Items</title>
  <meta name="description" content="ACLC College's digital lost and found system helps students and staff quickly find and claim lost items with secure verification.">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Rujnak's Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script type="module">
    import {
      initializeApp
    } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import {
      getAnalytics
    } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      onAuthStateChanged,
      signOut,
      sendEmailVerification,
      sendPasswordResetEmail
    } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
    import {
      getFirestore,
      doc,
      setDoc,
      getDoc,
      collection,
      addDoc,
      getDocs,
      query,
      where,
      Timestamp,
      orderBy
    } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
    import {
      getStorage,
      ref,
      uploadBytes,
      getDownloadURL
    } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-storage.js";


    const firebaseConfig = {
      apiKey: "AIzaSyBASqZ7VDxU_j6VEDN9pmhIDuDM1SU9qoI",
      authDomain: "findmyaclc.firebaseapp.com",
      projectId: "findmyaclc",
      storageBucket: "findmyaclc.appspot.com",
      messagingSenderId: "351280538849",
      appId: "1:351280538849:web:7b930e2e2885b40f4083a0",
      measurementId: "G-ZH9V9KH3H2"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    window.auth = auth;
    window.db = db;
    window.storage = storage;
    window.ref = ref;
    window.uploadBytes = uploadBytes;
    window.getDownloadURL = getDownloadURL;
    window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
    window.signInWithEmailAndPassword = signInWithEmailAndPassword;
    window.signOut = signOut;
    window.sendEmailVerification = sendEmailVerification;
    window.sendPasswordResetEmail = sendPasswordResetEmail;
    window.setDoc = setDoc;
    window.getDoc = getDoc;
    window.doc = doc;
    window.getDocs = getDocs;
    window.collection = collection;
    window.query = query;
    window.where = where;
    window.addDoc = addDoc;
    window.Timestamp = Timestamp;
    window.orderBy = orderBy;


    onAuthStateChanged(auth, async (user) => {
      const authButtons = document.querySelector('.auth-buttons');
      const homepage = document.getElementById('homepage');
      const studentDashboard = document.getElementById('studentDashboard');
      const staffDashboard = document.getElementById('staffDashboard');
      
      if (user && user.emailVerified) {
        homepage.style.display = 'none';
        
        let userData = null;
        try {
          const userDoc = await getDoc(doc(db, "users", user.uid));
          if (userDoc.exists()) {
            userData = userDoc.data();
            
            const currentEmailVerified = userDoc.data().emailVerified;
            if (currentEmailVerified !== user.emailVerified) {
              await setDoc(doc(db, "users", user.uid), {
                emailVerified: user.emailVerified
              }, { merge: true });
            }
          }
        } catch (error) {
          console.warn("Could not access user data:", error.message);
        }
        
        const username = userData?.username || user.email.split('@')[0];
        const userType = userData?.userType || 'student';
        
        authButtons.innerHTML = `
          <span class="user-welcome" data-testid="text-user-welcome">Welcome, ${username}</span>
          <button class="sign-out-btn" data-testid="button-signout">Sign Out</button>
        `;
        
        if (userType === 'staff') {
          studentDashboard.style.display = 'none';
          staffDashboard.style.display = 'block';
          document.getElementById('staffDashboardWelcome').textContent = `Welcome, ${username}!`;
          window.loadStaffDashboard();
        } else {
          staffDashboard.style.display = 'none';
          studentDashboard.style.display = 'block';
          document.getElementById('studentDashboardWelcome').textContent = `Welcome, ${username}!`;
          window.loadStudentDashboard();
        }
        
      } else if (user && !user.emailVerified) {
        homepage.style.display = 'block';
        studentDashboard.style.display = 'none';
        staffDashboard.style.display = 'none';
        authButtons.innerHTML = `
          <span class="user-welcome" data-testid="text-email-not-verified">Email Not Verified</span>
          <button class="sign-out-btn" data-testid="button-signout">Sign Out</button>
        `;
        
        window.showVerificationReminder(user);
      } else {
        homepage.style.display = 'block';
        studentDashboard.style.display = 'none';
        staffDashboard.style.display = 'none';
        authButtons.innerHTML = `
          <button class="sign-in-btn" data-testid="button-signin">Sign In</button>
          <button class="sign-up-btn" data-testid="button-signup">Sign Up</button>
        `;
      }
      
      document.querySelector('.sign-in-btn')?.addEventListener('click', window.showSignInModal);
      document.querySelector('.sign-up-btn')?.addEventListener('click', window.showSignUpModal);
      document.querySelector('.sign-out-btn')?.addEventListener('click', () => {
        signOut(auth).then(() => console.log('User signed out'))
          .catch((error) => console.error('Sign out error:', error));
      });
    });

    window.showVerificationReminder = function(user) {
      const verificationModal = document.createElement('div');
      verificationModal.id = 'verificationModal';
      verificationModal.className = 'modal';
      verificationModal.innerHTML = `
        <div class="modal-content verification-content" data-testid="modal-verification-content">
          <h2 data-testid="heading-verify-email">Verify Your Email</h2>
          <p data-testid="text-verification-instructions">We've sent a verification link to <strong>${user.email}</strong></p>
          <p data-testid="text-verification-action">Please check your inbox and click the verification link to activate your account.</p>
          <div class="verification-steps" data-testid="container-verification-steps">
            <div class="step" data-testid="step-1">1. Check your email inbox</div>
            <div class="step" data-testid="step-2">2. Find our verification email</div>
            <div class="step" data-testid="step-3">3. Click the verification link</div>
            <div class="step" data-testid="step-4">4. Return here and refresh the page</div>
          </div>
          <div class="verification-actions" data-testid="container-verification-actions">
            <button id="resendVerification" class="auth-submit-btn" data-testid="button-resend-verification">Resend Verification Email</button>
            <button id="closeVerification" class="auth-submit-btn secondary" data-testid="button-close-verification">Close</button>
          </div>
          <p class="verification-note" data-testid="text-verification-note">You need to verify your email to access the dashboard.</p>
        </div>
      `;
      document.body.appendChild(verificationModal);
      verificationModal.style.display = 'block';

      document.getElementById('resendVerification').addEventListener('click', function() {
        sendEmailVerification(user).then(() => {
          alert('Verification email sent! Please check your inbox.');
        }).catch((error) => {
          alert('Error sending verification email: ' + error.message);
        });
      });

      document.getElementById('closeVerification').addEventListener('click', function() {
        verificationModal.remove();
      });

      verificationModal.addEventListener('click', function(event) {
        if (event.target === verificationModal) {
          verificationModal.remove();
        }
      });

      const checkVerificationInterval = setInterval(async () => {
        try {
          await user.reload();
          
          if (user.emailVerified) {
            clearInterval(checkVerificationInterval);
            verificationModal.remove();
            window.location.reload();
          }
        } catch (error) {
          console.error('Error checking verification status:', error);
        }
      }, 1000);

      verificationModal.addEventListener('close', () => {
        clearInterval(checkVerificationInterval);
      });
    };
  </script>
</head>

<body>
  <header class="header" data-testid="header-main">
    <div class="logo-container" data-testid="logo-container">
      <div class="logo" data-testid="logo-icon">
        <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="logo-text" data-testid="text-logo">ACLC Lost & Found</div>
    </div>

    <div class="auth-buttons" data-testid="container-auth-buttons">
      <button class="sign-in-btn" data-testid="button-signin">Sign In</button>
      <button class="sign-up-btn" data-testid="button-signup">Sign Up</button>
    </div>
  </header>

  <main id="homepage" class="content" data-testid="page-homepage">
    <div class="content-box" data-testid="container-hero">
      <h2 data-testid="heading-hero">Lost Something? We'll Help You Find It</h2>
      <p class="box-description" data-testid="text-hero-description">ACLC College's digital lost and found system helps reunite students and staff with their missing belongings quickly and securely.</p>

      <div class="box-content" data-testid="container-features">
        <div class="feature" data-testid="feature-search">
          <div class="feature-icon" data-testid="icon-search">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3 data-testid="heading-feature-search">Search Lost Items</h3>
          <p data-testid="text-feature-search">Browse through our database of found items to see if your lost item has been turned in.</p>
        </div>
        <div class="feature" data-testid="feature-report">
          <div class="feature-icon" data-testid="icon-report">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.10457 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5M12 12H15M12 16H15M9 12H9.01M9 16H9.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3 data-testid="heading-feature-report">Report Items</h3>
          <p data-testid="text-feature-report">Found something? Report it so the owner can claim it back.</p>
        </div>
        <div class="feature" data-testid="feature-claim">
          <div class="feature-icon" data-testid="icon-claim">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3 data-testid="heading-feature-claim">Claim Process</h3>
          <p data-testid="text-feature-claim">Simple verification process to ensure items reach their rightful owners.</p>
        </div>
      </div>
    </div>

    <div class="additional-features" data-testid="container-additional-features">
      <div class="feature-box" data-testid="feature-realtime">
        <div class="feature-icon" data-testid="icon-realtime">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 6V12L16 14M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h3 data-testid="heading-feature-realtime">Real-Time Updates</h3>
        <p data-testid="text-feature-realtime">Get notified immediately when items matching your description are found.</p>
      </div>
      <div class="feature-box" data-testid="feature-secure">
        <div class="feature-icon" data-testid="icon-secure">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 15V3M12 15C10.3431 15 9 16.3431 9 18C9 19.6569 10.3431 21 12 21C13.6569 21 15 19.6569 15 18C15 16.3431 13.6569 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h3 data-testid="heading-feature-secure">Secure Storage</h3>
        <p data-testid="text-feature-secure">All found items are stored securely until claimed by verified owners.</p>
      </div>
      <div class="feature-box" data-testid="feature-community">
        <div class="feature-icon" data-testid="icon-community">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M17 20H22V18C22 16.3431 20.6569 15 19 15C18.0444 15 17.1931 15.4468 16.6438 16.1429M17 20H7M17 20V18C17 17.3438 16.8736 16.717 16.6438 16.1429M7 20H2V18C2 16.3431 3.34315 15 5 15C5.95561 15 6.80686 15.4468 7.35625 16.1429M7 20V18C7 17.3438 7.12642 16.717 7.35625 16.1429M7.35625 16.1429C8.0935 14.301 9.89482 13 12 13C14.1052 13 15.9065 14.301 16.6438 16.1429M15 7C15 8.65685 13.6569 10 12 10C10.3431 10 9 8.65685 9 7C9 5.34315 10.3431 4 12 4C13.6569 4 15 5.34315 15 7ZM21 10C21 11.1046 20.1046 12 19 12C17.8954 12 17 11.1046 17 10C17 8.89543 17.8954 8 19 8C20.1046 8 21 8.89543 21 10ZM7 10C7 11.1046 6.10457 12 5 12C3.89543 12 3 11.1046 3 10C3 8.89543 3.89543 8 5 8C6.10457 8 7 8.89543 7 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h3 data-testid="heading-feature-community">Community Driven</h3>
        <p data-testid="text-feature-community">Join our community of students and staff helping each other find lost items.</p>
      </div>
    </div>

    <div class="stats-box" data-testid="container-stats">
      <h2 data-testid="heading-stats">System Statistics</h2>
      <div class="stats-container" data-testid="container-stats-grid">
        <div class="stat-item" data-testid="stat-items-returned">
          <div class="stat-number" data-testid="stat-number-items">0</div>
          <div class="stat-label" data-testid="stat-label-items">Items Returned</div>
        </div>
        <div class="stat-item" data-testid="stat-success-rate">
          <div class="stat-number" data-testid="stat-number-success">0%</div>
          <div class="stat-label" data-testid="stat-label-success">Success Rate</div>
        </div>
        <div class="stat-item" data-testid="stat-active-users">
          <div class="stat-number" data-testid="stat-number-users">0</div>
          <div class="stat-label" data-testid="stat-label-users">Active Users</div>
        </div>
      </div>
    </div>
  </main>

  <div id="studentDashboard" class="dashboard" style="display: none;" data-testid="page-student-dashboard">
    <div class="dashboard-header" data-testid="container-dashboard-header">
      <h1 id="studentDashboardWelcome" data-testid="heading-student-welcome">Welcome!</h1>
      <p data-testid="text-dashboard-subtitle">Your dashboard for finding and reporting lost items</p>
    </div>

    <div class="dashboard-stats" data-testid="container-student-stats">
      <div class="stat-card" data-testid="card-student-lost">
        <div class="stat-value" id="studentLostCount" data-testid="stat-student-lost-count">0</div>
        <div class="stat-title" data-testid="stat-student-lost-label">Items I Lost</div>
      </div>
      <div class="stat-card" data-testid="card-student-claimed">
        <div class="stat-value" id="studentClaimedCount" data-testid="stat-student-claimed-count">0</div>
        <div class="stat-title" data-testid="stat-student-claimed-label">Items Claimed</div>
      </div>
      <div class="stat-card" data-testid="card-student-pending">
        <div class="stat-value" id="studentPendingCount" data-testid="stat-student-pending-count">0</div>
        <div class="stat-title" data-testid="stat-student-pending-label">Pending Claims</div>
      </div>
    </div>

    <div class="dashboard-actions" data-testid="container-student-actions">
      <button class="action-button primary" onclick="showReportItemModal('lost')" data-testid="button-report-lost">
        Report Lost Item
      </button>
      <button class="action-button secondary" onclick="showReportItemModal('found')" data-testid="button-report-found">
        Report Found Item
      </button>
    </div>

    <div class="dashboard-section" data-testid="section-recent-lost">
      <div class="section-header" data-testid="container-section-header">
        <h2 data-testid="heading-recent-lost">Recent Lost Items</h2>
        <div class="search-bar" data-testid="searchbar-student">
          <input type="text" id="studentSearchInput" placeholder="Search lost items..." data-testid="input-student-search">
          <button onclick="searchItems('student')" data-testid="button-student-search">Search</button>
        </div>
      </div>
      <div id="studentLostItemsList" class="items-grid" data-testid="list-student-lost-items"></div>
    </div>

    <div class="dashboard-section" data-testid="section-recent-found">
      <div class="section-header" data-testid="container-section-header-found">
        <h2 data-testid="heading-recent-found">Recent Found Items</h2>
      </div>
      <div id="studentFoundItemsList" class="items-grid" data-testid="list-student-found-items"></div>
    </div>
  </div>

  <div id="staffDashboard" class="dashboard" style="display: none;" data-testid="page-staff-dashboard">
    <div class="dashboard-header" data-testid="container-staff-header">
      <h1 id="staffDashboardWelcome" data-testid="heading-staff-welcome">Staff Dashboard</h1>
      <p data-testid="text-staff-subtitle">Manage lost and found items and review claims</p>
    </div>

    <div class="dashboard-stats" data-testid="container-staff-stats">
      <div class="stat-card" data-testid="card-total-items">
        <div class="stat-value" id="totalItemsCount" data-testid="stat-total-items-count">0</div>
        <div class="stat-title" data-testid="stat-total-items-label">Total Items</div>
      </div>
      <div class="stat-card" data-testid="card-pending-claims">
        <div class="stat-value" id="pendingClaimsCount" data-testid="stat-pending-claims-count">0</div>
        <div class="stat-title" data-testid="stat-pending-claims-label">Pending Claims</div>
      </div>
      <div class="stat-card" data-testid="card-resolved-claims">
        <div class="stat-value" id="resolvedClaimsCount" data-testid="stat-resolved-claims-count">0</div>
        <div class="stat-title" data-testid="stat-resolved-claims-label">Resolved (7 days)</div>
      </div>
    </div>

    <div class="dashboard-section" data-testid="section-pending-claims">
      <div class="section-header" data-testid="container-pending-claims-header">
        <h2 data-testid="heading-pending-claims">Pending Claims</h2>
      </div>
      <div id="pendingClaimsList" class="items-grid" data-testid="list-pending-claims"></div>
    </div>

    <div class="dashboard-section" data-testid="section-staff-lost">
      <div class="section-header" data-testid="container-staff-lost-header">
        <h2 data-testid="heading-staff-lost">Lost Items</h2>
        <div class="search-bar" data-testid="searchbar-staff">
          <input type="text" id="staffSearchInput" placeholder="Search items..." data-testid="input-staff-search">
          <button onclick="searchItems('staff')" data-testid="button-staff-search">Search</button>
        </div>
      </div>
      <div id="staffLostItemsList" class="items-grid" data-testid="list-staff-lost-items"></div>
    </div>

    <div class="dashboard-section" data-testid="section-staff-found">
      <div class="section-header" data-testid="container-staff-found-header">
        <h2 data-testid="heading-staff-found">Found Items</h2>
      </div>
      <div id="staffFoundItemsList" class="items-grid" data-testid="list-staff-found-items"></div>
    </div>
  </div>

  <div id="authModal" class="modal" data-testid="modal-auth">
    <div class="modal-content" data-testid="modal-auth-content">
      <span class="close-modal" data-testid="button-close-modal">&times;</span>
      
      <div id="signInForm" style="display: block;" data-testid="form-signin-container">
        <form id="signInFormElement" class="auth-form" data-testid="form-signin">
          <h2 data-testid="heading-signin">Sign In</h2>
          
          <div class="form-group" data-testid="formgroup-signin-email">
            <label for="signInEmail" data-testid="label-signin-email">Email Address</label>
            <input type="email" id="signInEmail" placeholder="Enter your email" required data-testid="input-signin-email">
          </div>

          <div class="form-group" data-testid="formgroup-signin-password">
            <label for="signInPassword" data-testid="label-signin-password">Password</label>
            <input type="password" id="signInPassword" placeholder="Enter your password" required data-testid="input-signin-password">
          </div>

          <div class="forgot-password-link" data-testid="container-forgot-password">
            <a href="#" id="forgotPasswordLink" data-testid="link-forgot-password">Forgot Password?</a>
          </div>

          <button type="submit" class="auth-submit-btn" data-testid="button-signin-submit">Sign In</button>
          
          <div class="auth-message" id="authMessage" data-testid="message-auth"></div>

          <div class="auth-switch" data-testid="container-switch-signup">
            Don't have an account? <a href="#" id="switchToSignUp" data-testid="link-switch-signup">Sign Up</a>
          </div>
        </form>
      </div>

      <div id="signUpForm" style="display: none;" data-testid="form-signup-container">
        <form id="signUpFormElement" class="auth-form" data-testid="form-signup">
          <h2 data-testid="heading-signup">Create Account</h2>
          
          <div class="form-group" data-testid="formgroup-username">
            <label for="signUpUsername" data-testid="label-username">Username</label>
            <input type="text" id="signUpUsername" placeholder="Choose a username" required data-testid="input-username">
            <div id="usernameAvailability" class="input-hint" data-testid="hint-username"></div>
          </div>

          <div class="form-group" data-testid="formgroup-usertype">
            <label data-testid="label-usertype">I am a:</label>
            <div class="radio-group" data-testid="radiogroup-usertype">
              <label class="radio-label" data-testid="label-radio-student">
                <input type="radio" name="userType" value="student" required data-testid="radio-student">
                <span class="radio-custom" data-testid="radio-custom-student"></span>
                Student
              </label>
              <label class="radio-label" data-testid="label-radio-staff">
                <input type="radio" name="userType" value="staff" data-testid="radio-staff">
                <span class="radio-custom" data-testid="radio-custom-staff"></span>
                Staff
              </label>
            </div>
          </div>

          <div id="studentIdGroup" class="form-group id-input-group" style="display: none;" data-testid="formgroup-student-id">
            <label for="studentId" data-testid="label-student-id">Student ID (11 digits)</label>
            <input type="text" id="studentId" placeholder="24xxxxxxxxx" maxlength="11" data-testid="input-student-id">
            <span class="input-hint" data-testid="hint-student-id">Example: 24101234567</span>
          </div>

          <div id="staffIdGroup" class="form-group id-input-group" style="display: none;" data-testid="formgroup-staff-id">
            <label for="staffId" data-testid="label-staff-id">Staff ID</label>
            <input type="text" id="staffId" placeholder="Enter your staff ID" data-testid="input-staff-id">
          </div>

          <div class="form-group" data-testid="formgroup-signup-email">
            <label for="signUpEmail" data-testid="label-signup-email">Email Address</label>
            <input type="email" id="signUpEmail" placeholder="Enter your email" required data-testid="input-signup-email">
            <div id="emailAvailability" class="input-hint" data-testid="hint-email"></div>
          </div>

          <div class="form-group" data-testid="formgroup-signup-password">
            <label for="signUpPassword" data-testid="label-signup-password">Password</label>
            <input type="password" id="signUpPassword" placeholder="Create a strong password" required data-testid="input-signup-password">
            <div class="password-strength" data-testid="container-password-strength">
              <div class="strength-bar" data-testid="bar-password-strength"></div>
              <div class="strength-text" data-testid="text-password-strength">Strength: <span id="strengthMessage" data-testid="text-strength-level">Weak</span></div>
            </div>
          </div>

          <div class="form-group" data-testid="formgroup-confirm-password">
            <label for="confirmPassword" data-testid="label-confirm-password">Confirm Password</label>
            <input type="password" id="confirmPassword" placeholder="Re-enter your password" required data-testid="input-confirm-password">
            <div id="matchMessage" class="password-match" data-testid="message-password-match"></div>
          </div>

          <button type="submit" class="auth-submit-btn" data-testid="button-signup-submit">Create Account</button>
          
          <div class="auth-switch" data-testid="container-switch-signin">
            Already have an account? <a href="#" id="switchToSignIn" data-testid="link-switch-signin">Sign In</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="forgotPasswordModal" class="modal" data-testid="modal-forgot-password">
    <div class="modal-content" data-testid="modal-forgot-password-content">
      <span class="close-modal" data-testid="button-close-forgot-modal">&times;</span>
      
      <form id="forgotPasswordForm" class="auth-form" data-testid="form-forgot-password">
        <h2 data-testid="heading-forgot-password">Reset Password</h2>
        <p class="box-description" data-testid="text-forgot-password-description">Enter your email address and we'll send you a link to reset your password.</p>
        
        <div class="form-group" data-testid="formgroup-reset-email">
          <label for="resetEmail" data-testid="label-reset-email">Email Address</label>
            <input type="email" id="resetEmail" placeholder="Enter your email" required data-testid="input-reset-email">
        </div>

        <button type="submit" class="auth-submit-btn" data-testid="button-send-reset">Send Reset Link</button>
        
        <div class="auth-message" id="forgotPasswordMessage" data-testid="message-forgot-password"></div>

        <div class="auth-switch" data-testid="container-back-signin">
          <a href="#" id="backToSignIn" data-testid="link-back-signin">Back to Sign In</a>
        </div>
      </form>
    </div>
  </div>

  <div id="reportItemModal" class="modal" data-testid="modal-report-item">
    <div class="modal-content" data-testid="modal-report-item-content">
      <span class="close-modal" data-testid="button-close-report-modal">&times;</span>
      <form id="reportItemForm" class="auth-form" data-testid="form-report-item">
        <h2 id="reportItemModalTitle" data-testid="heading-report-item">Report an Item</h2>
        <input type="hidden" id="reportItemType" name="reportItemType">

        <div class="form-group" data-testid="formgroup-item-name">
          <label for="itemName" data-testid="label-item-name">Item Name</label>
          <input type="text" id="itemName" placeholder="e.g., Black Backpack" required data-testid="input-item-name">
        </div>

        <div class="form-group" data-testid="formgroup-item-description">
          <label for="itemDescription" data-testid="label-item-description">Description</label>
          <textarea id="itemDescription" placeholder="Provide details like brand, color, identifying marks..." required rows="3" data-testid="input-item-description"></textarea>
        </div>

        <div class="form-group" data-testid="formgroup-item-category">
          <label for="itemCategory" data-testid="label-item-category">Category</label>
          <select id="itemCategory" required data-testid="select-item-category">
            <option value="" disabled selected>Select a category</option>
            <option value="electronics">Electronics</option>
            <option value="books">Books & Notes</option>
            <option value="clothing">Clothing & Accessories</option>
            <option value="keys">Keys</option>
            <option value="identification">IDs & Cards</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="form-group" data-testid="formgroup-item-location">
          <label for="itemLocation" data-testid="label-item-location">Location</label>
          <input type="text" id="itemLocation" placeholder="e.g., Library, 2nd Floor" required data-testid="input-item-location">
        </div>

        <div class="form-group" data-testid="formgroup-item-date">
          <label for="itemDate" data-testid="label-item-date">Date</label>
          <input type="date" id="itemDate" required data-testid="input-item-date">
        </div>
        
        <div class="form-group" data-testid="formgroup-item-image">
          <label for="itemImage" data-testid="label-item-image">Upload Image (Optional)</label>
          
          <!-- Rujnak's Image Upload System -->
          <div class="image-upload-section">
            <input type="file" id="itemImage" accept="image/*" style="display: none;" data-testid="input-item-image">
            
            <div class="image-upload-buttons">
              <button type="button" id="selectImageBtn" class="select-btn" data-testid="button-select-image">
                Select Image
              </button>
              <button type="button" id="uploadImageBtn" class="upload-btn" data-testid="button-upload-image" style="display: none;">
                Upload Image
              </button>
            </div>
            
            <!-- Square preview container -->
            <div class="item-image-container" style="max-width: 200px; margin: 10px auto;">
              <img id="imagePreview" src="" alt="Image Preview" style="display: none;" data-testid="image-preview"/>
            </div>
            
            <progress id="uploadProgressBar" value="0" max="100" style="display: none;"></progress>
            <div id="uploadProgressText" style="display: none;"></div>
            
            <div class="input-hint">Image will be cropped to square format in the item list</div>
          </div>
        </div>

        <button type="submit" class="auth-submit-btn" data-testid="button-report-submit">Submit Report</button>
        <div class="auth-message" id="reportItemMessage" data-testid="message-report-item"></div>
      </form>
    </div>
  </div>
  
  <!-- AI Claim Verification Modal -->
    <div id="claimVerificationModal" class="modal" data-testid="modal-claim-verification">
      <div class="modal-content" data-testid="modal-claim-content">
        <span class="close-modal" data-testid="button-close-claim-modal">&times;</span>
        
        <div class="auth-form" data-testid="form-claim-verification">
          <h2 data-testid="heading-claim-verification">Verify Ownership</h2>
          
          <div class="chat-container" id="claimChatContainer" data-testid="container-chat-messages">
            <!-- AI and user messages will appear here -->
          </div>
          
          <div id="claimTypingIndicator" class="chatbot-typing" style="display: none;" data-testid="indicator-typing">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
          <div class="chatbot-input-area" data-testid="container-chat-input">
            <input type="text" id="claimUserInput" placeholder="Type your answer..." data-testid="input-chat-response">
            <button id="claimSendBtn" data-testid="button-send-response">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                      d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
              </svg>
            </button>
          </div>
          
          <div class="verification-progress" data-testid="container-verification-progress" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="verificationProgressBar"></div>
            </div>
            <div class="progress-text" id="verificationProgressText" data-testid="text-progress">Verification: 0%</div>
          </div>
          
          <div class="auth-message" id="claimMessage" data-testid="message-claim-status"></div>
          
          <!--div class="download-section" style="text-align: center; margin-top: 20px; display: none;" id="downloadSection" data-testid="container-download"-->
            <!--button id="downloadYmlBtn" class="auth-submit-btn secondary" data-testid="button-download-yml">Download Verification Log</button-->
          <!--/div-->
        </div>
      </div>
    </div>
  
    <!-- AI Chatbot -->
    <div id="chatbotBubble" class="chatbot-bubble">
      <div class="chatbot-bubble-inner">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
        </svg>
      </div>
    </div>
    
    <div id="chatbotWindow" class="chatbot-window" style="display: none;">
      <div class="chatbot-header">
        <div class="chatbot-header-info">
          <div id="chatbotStatusDot" class="chatbot-status-dot online"></div>
          <div>
            <div class="chatbot-title">Lost & Found Assistant</div>
            <div id="chatbotSubtitle" class="chatbot-subtitle">Guest Mode</div>
          </div>
        </div>
        <button id="chatbotClose" class="chatbot-close">Ã—</button>
      </div>
      
      <div id="chatbotMessages" class="chatbot-messages">
        <!-- Messages will be added here dynamically -->
      </div>
      
      <div id="chatbotTyping" class="chatbot-typing" style="display: none;">
        <span></span>
        <span></span>
        <span></span>
      </div>
      
      <div class="chatbot-input-area">
        <input type="text" id="chatbotInput" placeholder="Ask about lost and found items..." />
        <button id="chatbotSend">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                  d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
          </svg>
        </button>
      </div>
    </div>

  <script src="script.js"></script>
</body>

</html>